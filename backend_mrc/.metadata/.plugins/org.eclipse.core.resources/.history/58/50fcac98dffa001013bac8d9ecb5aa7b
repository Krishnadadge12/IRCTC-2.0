package com.mrc.service;

import java.util.List;

import org.modelmapper.ModelMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.mrc.dtos.CoachDTO;
import com.mrc.entities.train.Coach;
import com.mrc.repository.CoachRepository;

@Service
public class CoachServiceImpl implements CoachService {

    @Autowired
    private CoachRepository coachRepo;

    @Autowired
    private ModelMapper mapper;

    @Override
    public CoachDTO addCoach(CoachDTO dto) {
        Coach coach = mapper.map(dto, Coach.class);
        return mapper.map(coachRepo.save(coach), CoachDTO.class);
    }

    @Override
    public List<CoachDTO> getAllCoaches() {
        return coachRepo.findAll()
                .stream()
                .map(c -> mapper.map(c, CoachDTO.class))
                .toList();
    }

    @Override
    public CoachDTO updateCoach(Long id, CoachDTO dto) {
        Coach coach = coachRepo.findById(id).orElseThrow();
        coach.setCoachType(dto.getCoachType());
        coach.setTotalSeats(dto.getTotalSeats());
        coach.setAvailableSeats(dto.getAvailableSeats());
        return mapper.map(coachRepo.save(coach), CoachDTO.class);
    }

    @Override
    public void deleteCoach(Long id) {
        coachRepo.deleteById(id);
    }
}
